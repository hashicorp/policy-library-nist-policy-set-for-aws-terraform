# AWS AppSync GraphQL APIs should not be authenticated with API keys

| Provider            |           Category         |
| ------------------- |  ------------------------  |
| Amazon Web Services |  Secure Access Management  |

## Description

This control checks whether your application uses an API key to interact with an AWS AppSync GraphQL API. The control fails if an AWS AppSync GraphQL API is authenticated with an API key.

An API key is a hard-coded value in your application that is generated by the AWS AppSync service when you create an unauthenticated GraphQL endpoint. If this API key is compromised, your endpoint is vulnerable to unintended access. Unless you are supporting a publicly accessible application or website, we don't recommend using an API key for authentication.

This rule is covered by the [appsync-graphql-api-should-not-authenticate-with-api-keys](https://github.com/hashicorp/policy-library-NIST-Policy-Set-for-AWS-Terraform/blob/main/policies/appsync/appsync-graphql-api-should-not-authenticate-with-api-keys.sentinel) policy.

## Policy Results (Pass)

```bash
trace:
        Pass - appsync-graphql-api-should-not-authenticate-with-api-keys.sentinel

        Description:
        This policy requires resources of type `aws_appsync_graphql_api` have
        attribute "authentication_type" should not be "API_KEY".

        Print messages:

        → → Overall Result: true

        This result means that all resources have passed the policy check for the policy appsync-graphql-api-should-not-authenticate-with-api-keys.

        ✓ Found 0 resource violations

        appsync-graphql-api-should-not-authenticate-with-api-keys.sentinel:44:1 - Rule "main"
        Value:
            true
```

---

## Policy Results (Fail)

```bash
trace:
        Fail - appsync-graphql-api-should-not-authenticate-with-api-keys.sentinel

        Description:
        This policy requires resources of type `aws_appsync_graphql_api` have
        attribute "authentication_type" should not be "API_KEY".

        Print messages:

        → → Overall Result: false

        This result means that not all resources passed the policy check and the protected behavior is not allowed for the policy appsync-graphql-api-should-not-authenticate-with-api-keys.

        Found 1 resource violations

        → Module name: root
        ↳ Resource Address: aws_appsync_graphql_api.example
            | ✗ failed
            | Attribute 'authentication_type' must not be set to 'API_KEY' for 'aws_appsync_graphql_api' resources. Refer to https://docs.aws.amazon.com/securityhub/latest/userguide/appsync-controls.html#appsync-5 for more details.


        appsync-graphql-api-should-not-authenticate-with-api-keys.sentinel:44:1 - Rule "main"
        Value:
            false
```

---
